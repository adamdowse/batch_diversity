built model with input shape = (28, 28, 1, 1)
Model: "sequential"
_________________________________________________________________
 Layer (type)                Output Shape              Param #
=================================================================
 conv2d (Conv2D)             (None, 26, 26, 32)        320
 max_pooling2d (MaxPooling2D  (None, 13, 13, 32)       0
 )
 flatten (Flatten)           (None, 5408)              0
 dense (Dense)               (None, 100)               540900
 dense_1 (Dense)             (None, 10)                1010
 softmax (Softmax)           (None, 10)                0
=================================================================
Total params: 542,230
Trainable params: 542,230
Non-trainable params: 0
_________________________________________________________________
There are  188  batches in the warm start
Started Training
tf.Tensor(
[[[[0.]
   [0.]
   [0.]
   ...
   [0.]
   [0.]
   [0.]]
  [[0.]
   [0.]
   [0.]
   ...
   [0.]
   [0.]
   [0.]]
  [[0.]
   [0.]
   [0.]
   ...
   [0.]
   [0.]
   [0.]]
  ...
  [[0.]
   [0.]
   [0.]
   ...
   [0.]
   [0.]
   [0.]]
  [[0.]
   [0.]
   [0.]
   ...
   [0.]
   [0.]
   [0.]]
  [[0.]
   [0.]
   [0.]
   ...
   [0.]
   [0.]
   [0.]]]
 [[[0.]
   [0.]
   [0.]
   ...
   [0.]
   [0.]
   [0.]]
  [[0.]
   [0.]
   [0.]
   ...
   [0.]
   [0.]
   [0.]]
  [[0.]
   [0.]
   [0.]
   ...
   [0.]
   [0.]
   [0.]]
  ...
  [[0.]
   [0.]
   [0.]
   ...
   [0.]
   [0.]
   [0.]]
  [[0.]
   [0.]
   [0.]
   ...
   [0.]
   [0.]
   [0.]]
  [[0.]
   [0.]
   [0.]
   ...
   [0.]
   [0.]
   [0.]]]
 [[[0.]
   [0.]
   [0.]
   ...
   [0.]
   [0.]
   [0.]]
  [[0.]
   [0.]
   [0.]
   ...
   [0.]
   [0.]
   [0.]]
  [[0.]
   [0.]
   [0.]
   ...
   [0.]
   [0.]
   [0.]]
  ...
  [[0.]
   [0.]
   [0.]
   ...
   [0.]
   [0.]
   [0.]]
  [[0.]
   [0.]
   [0.]
   ...
   [0.]
   [0.]
   [0.]]
  [[0.]
   [0.]
   [0.]
   ...
   [0.]
   [0.]
   [0.]]]
 ...
 [[[0.]
   [0.]
   [0.]
   ...
   [0.]
   [0.]
   [0.]]
  [[0.]
   [0.]
   [0.]
   ...
   [0.]
   [0.]
   [0.]]
  [[0.]
   [0.]
   [0.]
   ...
   [0.]
   [0.]
   [0.]]
  ...
  [[0.]
   [0.]
   [0.]
   ...
   [0.]
   [0.]
   [0.]]
  [[0.]
   [0.]
   [0.]
   ...
   [0.]
   [0.]
   [0.]]
  [[0.]
   [0.]
   [0.]
   ...
   [0.]
   [0.]
   [0.]]]
 [[[0.]
   [0.]
   [0.]
   ...
   [0.]
   [0.]
   [0.]]
  [[0.]
   [0.]
   [0.]
   ...
   [0.]
   [0.]
   [0.]]
  [[0.]
   [0.]
   [0.]
   ...
   [0.]
   [0.]
   [0.]]
  ...
  [[0.]
   [0.]
   [0.]
   ...
   [0.]
   [0.]
   [0.]]
  [[0.]
   [0.]
   [0.]
   ...
   [0.]
   [0.]
   [0.]]
  [[0.]
   [0.]
   [0.]
   ...
   [0.]
   [0.]
   [0.]]]
 [[[0.]
   [0.]
   [0.]
   ...
   [0.]
   [0.]
   [0.]]
  [[0.]
   [0.]
   [0.]
   ...
   [0.]
   [0.]
   [0.]]
  [[0.]
   [0.]
   [0.]
   ...
   [0.]
   [0.]
   [0.]]
  ...
  [[0.]
   [0.]
   [0.]
   ...
   [0.]
   [0.]
   [0.]]
  [[0.]
   [0.]
   [0.]
   ...
   [0.]
   [0.]
   [0.]]
  [[0.]
   [0.]
   [0.]
   ...
   [0.]
   [0.]
   [0.]]]], shape=(32, 28, 28, 1), dtype=float32)
tf.Tensor(
[[0. 0. 0. 0. 0. 0. 0. 1. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 1.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 1.]
 [1. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 1.]
 [0. 0. 0. 1. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 1. 0.]
 [1. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 1. 0. 0.]
 [0. 1. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 1. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 1. 0.]
 [0. 0. 0. 0. 0. 0. 0. 1. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 1. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 1. 0. 0.]
 [0. 0. 1. 0. 0. 0. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 1. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 1. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 1. 0.]
 [0. 0. 0. 0. 0. 1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 1.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 1.]
 [0. 1. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 1. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 1. 0.]
 [0. 0. 0. 1. 0. 0. 0. 0. 0. 0.]
 [0. 0. 1. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 1. 0. 0. 0. 0. 0. 0.]
 [0. 0. 1. 0. 0. 0. 0. 0. 0. 0.]], shape=(32, 10), dtype=float32)
2022-08-24 16:31:56.397560: W tensorflow/core/kernels/data/cache_dataset_ops.cc:856] The calling iterator did not fully read the dataset being cached. In order to avoid unexpected truncation of the dataset, the partially cached contents of the dataset  will be discarded. This can happen if you have an input pipeline similar to `dataset.cache().take(k).repeat()`. You should use `dataset.take(k).cache().repeat()` instead.
Traceback (most recent call last):
  File "Main.py", line 86, in <module>
    wandb.log({ 'train_acc':train_acc_metric.result().numpy(),
  File "/com.docker.devenvironments.code/supporting_functions.py", line 272, in k_diversity
    pnt()
NameError: name 'pnt' is not defined
1/1 [==============================] - 0s 72ms/step
[[ 0.01230466  0.03407945 -0.00318034 -0.09361889 -0.00097966 -0.01935396
   0.02658395  0.02253539  0.00516134  0.00707813]
 [ 0.0024918   0.03246505 -0.00232714 -0.06951071 -0.00047672 -0.01669883
   0.02432813  0.01701611  0.00651845 -0.00286223]
 [ 0.01557611  0.03115242  0.00565889 -0.11663824 -0.00616739 -0.00974162
   0.02584905  0.01701416  0.00707445  0.01109716]
 [ 0.01873678  0.03356306 -0.0009915  -0.10338452  0.00370105 -0.01888369
   0.02456673  0.02575681  0.00631708  0.00625547]
 [ 0.00552993  0.02991891 -0.00022747 -0.03338549 -0.00691015 -0.02164762
   0.02117503  0.01814252  0.00018534 -0.01074496]]
[[0 0 0 0 1 0 0 0 0 0]
 [0 1 0 0 0 0 0 0 0 0]
 [1 0 0 0 0 0 0 0 0 0]
 [0 0 0 0 0 0 0 1 0 0]
 [0 0 0 0 0 0 0 0 1 0]]
[[ 1.23046637e-02  3.40794474e-02 -3.18033854e-03 -9.36188921e-02
  -1.00097966e+00 -1.93539578e-02  2.65839510e-02  2.25353856e-02
   5.16133755e-03  7.07812607e-03]
 [ 2.49179848e-03 -9.67534948e-01 -2.32714368e-03 -6.95107058e-02
  -4.76721674e-04 -1.66988317e-02  2.43281312e-02  1.70161054e-02
   6.51845150e-03 -2.86222901e-03]
 [-9.84423891e-01  3.11524179e-02  5.65889431e-03 -1.16638236e-01
  -6.16738806e-03 -9.74161550e-03  2.58490518e-02  1.70141645e-02
   7.07445201e-03  1.10971574e-02]
 [ 1.87367816e-02  3.35630625e-02 -9.91496723e-04 -1.03384517e-01
   3.70105263e-03 -1.88836902e-02  2.45667286e-02 -9.74243190e-01
   6.31707534e-03  6.25546556e-03]
 [ 5.52993407e-03  2.99189109e-02 -2.27472745e-04 -3.33854891e-02
  -6.91015320e-03 -2.16476191e-02  2.11750343e-02  1.81425214e-02
  -9.99814656e-01 -1.07449591e-02]]
(5, 10)
1/1 [==============================] - 0s 18ms/step
[[ 0.00539299  0.03535103  0.0006325  -0.07954232 -0.00365062 -0.01127043
   0.02639889  0.01464642  0.00714095  0.00342983]
 [ 0.01256907  0.03623867  0.00347463 -0.10014343 -0.00181614 -0.01094605
   0.03373194  0.02255886  0.01071963  0.00439289]
 [ 0.0089413   0.03096735 -0.00259371 -0.0789369  -0.00413145 -0.01736729
   0.03362943  0.02165109  0.00554671  0.00924534]
 [ 0.00391364  0.02949899 -0.00234481 -0.06030052 -0.00524102 -0.01425812
   0.02385919  0.01640583  0.00188391 -0.00477903]
 [ 0.01441126  0.0320079   0.00703789 -0.11816552 -0.00550298 -0.01187485
   0.03599026  0.02202064  0.00299847  0.01831495]]
[[0 1 0 0 0 0 0 0 0 0]
 [0 0 1 0 0 0 0 0 0 0]
 [0 0 0 0 0 0 0 1 0 0]
 [0 1 0 0 0 0 0 0 0 0]
 [0 0 0 0 0 0 1 0 0 0]]
[[ 5.39298961e-03 -9.64648969e-01  6.32504467e-04 -7.95423239e-02
  -3.65061685e-03 -1.12704281e-02  2.63988897e-02  1.46464212e-02
   7.14095309e-03  3.42983380e-03]
 [ 1.25690736e-02  3.62386666e-02 -9.96525373e-01 -1.00143433e-01
  -1.81613956e-03 -1.09460512e-02  3.37319374e-02  2.25588642e-02
   1.07196346e-02  4.39289398e-03]
 [ 8.94130114e-03  3.09673473e-02 -2.59371335e-03 -7.89369047e-02
  -4.13145125e-03 -1.73672866e-02  3.36294286e-02 -9.78348907e-01
   5.54670859e-03  9.24534164e-03]
 [ 3.91363585e-03 -9.70501015e-01 -2.34481320e-03 -6.03005216e-02
  -5.24101593e-03 -1.42581193e-02  2.38591880e-02  1.64058264e-02
   1.88390852e-03 -4.77902964e-03]
 [ 1.44112566e-02  3.20078991e-02  7.03789061e-03 -1.18165515e-01
  -5.50297834e-03 -1.18748527e-02 -9.64009736e-01  2.20206417e-02
   2.99847289e-03  1.83149520e-02]]
(5, 20)